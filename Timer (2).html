<!DOCTYPE html>
<html lang="uz">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bar Daftarchasi</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #f3f3f3;
    margin: 0;
    padding: 20px;
  }
  h1 { text-align: center; color: #333; }
  .tables {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
    gap: 15px;
    margin-bottom: 40px;
  }
  .table-box {
    background: #fff;
    border-radius: 10px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    padding: 15px;
  }
  .table-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
  }
  .summa { font-weight: bold; color: #27ae60; }
  .drink {
    display: flex; align-items: center; justify-content: space-between;
    margin: 6px 0; background: #f8f8f8; border-radius: 6px; padding: 6px 10px;
  }
  .drink button {
    width: 30px; height: 30px; font-size: 18px; border: none;
    border-radius: 50%; cursor: pointer; color: white;
  }
  .minus { background: #e74c3c; }
  .plus { background: #27ae60; }
  .drink span { flex: 1; text-align: center; font-weight: bold; color: #333; }
  .add-btn {
    background: #3498db; color: white; border: none; padding: 8px 14px;
    border-radius: 8px; font-size: 14px; cursor: pointer; width: 100%; margin-top: 10px;
  }
  .add-btn:hover { background: #2980b9; }

  /* Hisobot oynasi */
  .modal {
    display: none;
    position: fixed;
    z-index: 10;
    left: 0; top: 0;
    width: 100%; height: 100%;
    background-color: rgba(0,0,0,0.6);
  }
  .modal-content {
    background: #fff;
    margin: 5% auto;
    padding: 20px;
    border-radius: 10px;
    width: 90%;
    max-width: 600px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    position: relative;
  }
  .close-btn {
    background: #e74c3c;
    color: white;
    border: none;
    border-radius: 6px;
    padding: 6px 10px;
    cursor: pointer;
    font-size: 14px;
    float: right;
  }
  .report-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  ul { list-style-type: none; padding: 0; }
  li {
    background: #f9f9f9;
    border-radius: 8px;
    padding: 10px;
    margin-bottom: 10px;
  }
  li button {
    float: right;
    background: #e74c3c;
    color: white;
    border: none;
    border-radius: 4px;
    padding: 3px 8px;
    cursor: pointer;
  }
  .footer {
    text-align: center;
    margin-top: 20px;
  }
  .footer button {
    background: #e74c3c; color: white; border: none;
    padding: 10px 20px; border-radius: 8px; font-size: 16px; cursor: pointer;
  }
  .footer button:hover { background: #c0392b; }

  .show-report-btn {
    display: block;
    margin: 0 auto 15px;
    padding: 10px 20px;
    background: #2ecc71;
    color: white;
    border: none;
    border-radius: 8px;
    font-size: 16px;
    cursor: pointer;
  }
  .show-report-btn:hover { background: #27ae60; }
</style>
</head>
<body>
<h1>üçπ Bar Daftarchasi</h1>

<button class="show-report-btn" onclick="openReport()">üìã Hisobotni ko‚Äòrish</button>

<div class="tables" id="tables"></div>

<div id="reportModal" class="modal">
  <div class="modal-content">
    <div class="report-header">
      <h2>üßæ Hisobot</h2>
      <button class="close-btn" onclick="closeReport()">Yopish ‚úñ</button>
    </div>
    <ul id="reportList"></ul>
    <div class="footer">
      <button onclick="clearAll()">‚ôªÔ∏è Hammasini o‚Äòchirish</button>
    </div>
  </div>
</div>

<script>
const drinks = [
  { name: "Cola 0.25L", price: 4000 },
  { name: "Cola 0.5L", price: 7000 },
  { name: "Cola 1L", price: 12000 },
  { name: "Cola 1.5L", price: 15000 },
  { name: "Cola 2L", price: 20000 },
  { name: "Fanta 0.25L", price: 4000 },
  { name: "Fanta 0.5L", price: 7000 },
  { name: "Fanta 1L", price: 12000 },
  { name: "Fanta 1.5L", price: 15000 },
  { name: "Fanta 2L", price: 20000 },
  { name: "Flavis 0.6L", price: 7000 },
  { name: "Flavis 1.2L", price: 13000 },
  { name: "Ark Tea 0.5L", price: 6000 },
  { name: "Ark Tea 1L", price: 12000 },
];

const tables = {};
let reports = [];

function createTables() {
  const container = document.getElementById("tables");
  for (let i = 1; i <= 8; i++) {
    tables[i] = {};
    const div = document.createElement("div");
    div.className = "table-box";
    div.innerHTML = `
      <div class="table-header">
        <h3>ü™ë Stol ${i}</h3>
        <div class="summa" id="sum${i}">0 so'm</div>
      </div>
      ${drinks.map((d, idx) => `
        <div class="drink">
          <button class="minus" onclick="updateCount(${i}, ${idx}, -1)">-</button>
          <span id="t${i}d${idx}">${d.name} (0)</span>
          <button class="plus" onclick="updateCount(${i}, ${idx}, 1)">+</button>
        </div>
      `).join("")}
      <button class="add-btn" onclick="addToReport(${i})">‚ûï Qo'shish</button>
    `;
    container.appendChild(div);
  }
}

function updateCount(table, drinkIdx, delta) {
  const drink = drinks[drinkIdx];
  if (!tables[table][drink.name]) tables[table][drink.name] = 0;
  tables[table][drink.name] = Math.max(0, tables[table][drink.name] + delta);
  document.getElementById(`t${table}d${drinkIdx}`).textContent =
    `${drink.name} (${tables[table][drink.name]})`;
  updateSum(table);
}

function updateSum(table) {
  let sum = 0;
  for (let d in tables[table]) {
    const qty = tables[table][d];
    const price = drinks.find(x => x.name === d)?.price || 0;
    sum += qty * price;
  }
  document.getElementById(`sum${table}`).textContent = sum.toLocaleString() + " so'm";
}

function addToReport(table) {
  const now = new Date();
  const date = `${now.getDate()}.${now.getMonth()+1}.${now.getFullYear()} ${now.toLocaleTimeString()}`;
  let total = 0;
  const items = [];

  for (let d in tables[table]) {
    const qty = tables[table][d];
    if (qty > 0) {
      const price = drinks.find(x => x.name === d).price;
      total += qty * price;
      items.push(`${qty}x ${d}`);
    }
  }

  if (items.length === 0) return alert("Hech narsa tanlanmagan!");

  reports.push({
    id: Date.now(),
    table,
    date,
    total,
    items
  });

  tables[table] = {};
  const tableBox = document.querySelectorAll(".table-box")[table - 1];
  const spans = tableBox.querySelectorAll("span[id^='t" + table + "']");
  spans.forEach((span, idx) => span.textContent = `${drinks[idx].name} (0)`);
  updateSum(table);
}

function openReport() {
  const modal = document.getElementById("reportModal");
  const list = document.getElementById("reportList");
  if (reports.length === 0) list.innerHTML = "<li>Hozircha hisobot yo‚Äòq.</li>";
  else {
    list.innerHTML = reports.map(r => `
      <li>
        <b>ü™ë ${r.table}-stol</b><br>
        ${r.date}<br>
        Narx: <b>${r.total.toLocaleString()} so'm</b><br>
        Ichimliklar:<br>
        ${r.items.map(i => "‚Ä¢ " + i).join("<br>")}
        <button onclick="deleteReport(${r.id})">O‚Äòchirish</button>
      </li>
    `).join("");
  }
  modal.style.display = "block";
}

function closeReport() {
  document.getElementById("reportModal").style.display = "none";
}

function deleteReport(id) {
  reports = reports.filter(r => r.id !== id);
  openReport();
}

function clearAll() {
  if (confirm("Barcha hisobotlarni o‚Äòchirishni xohlaysizmi?")) {
    reports = [];
    openReport();
  }
}

window.onclick = function(event) {
  const modal = document.getElementById("reportModal");
  if (event.target == modal) modal.style.display = "none";
};

createTables();
</script>
</body>
</html>